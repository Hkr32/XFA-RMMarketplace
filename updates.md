# Обновления

## 5.2.1 от 24 января 2023

### Отладочный релиз

### Исправлены ошибки:

- Argument 1 passed to XF\Mvc\Entity\Entity::addCascadedSave() must be an instance of XF\Mvc\Entity\Entity, null given, called in src/addons/XFA/RMMarketplace/Pub/controller/Dashboard.php on line 86

## 5.2.0 от 11 января 2023

### Исправление ошибок и новая функция

### Исправлены ошибки:

- Call to a member function getCommunicationDataFromType() on null - src/addons/XFA/RMMarketplace/Service/Purchase/Notify.php:79

### Новые возможности:

- Возможность автоматической генерации лицензионного ключа, активируемая опцией и настраиваемая для каждого ресурса

## 5.1.1 от 2 января 2023

### Отладочный релиз

### Исправлены ошибки:

- ErrorException: Job XFA\RMMarketplaceDiscountsApplier: [E_WARNING] Attempt to read property "type" on null src/addons/XFA/RMMarketplace/Job/DiscountsApplier.php:36
- Error: Call to a member function fastUpdate() on null src/addons/XFA/RMMarketplace/Job/DiscountsApplier.php:100
- ErrorException: [E_NOTICE] Undefined variable: resourceIds src/addons/XFA/RMMarketplace/Job/DiscountsApplier.php:79
- Error: Call to a member function getCommunicationDataFromType() on null - src/addons/XFA/RMMarketplace/Service/Purchase/Notify.php:72
- Цены на ресурсы сбрасываются после обновления

> Для тех, кто обновился до последней версии и столкнулся с последней ошибкой, я очень сожалею об этом.
> Вам необходимо вручную вернуть цены, которые были до обновления (если вы этого не видели и уже сбросили обратно к предустановленной резервной копии базы данных).
> Я искренне извиняюсь за это.

## 5.1.0 от 31 декабря 2022

### Исправления ошибок и новые функции, в том числе долгожданные скидки

Я сказал, что выпущу ее до конца года, и вот она, долгожданная версия 5.1.0, в которой представлены некоторые новые функции и, в частности, возможность создания скидок. Я надеюсь, вам понравится эта новая версия, и я желаю всем вам счастливого Нового 2023 года!

### Исправлены ошибки:

- ErrorException: [E_WARNING] Attempt to read property "shipping" on null src/addons/XFA/RMMarketplace/Pub/View/Invoice.php:129
- Error initialising PayPal communication error when seller has bypass percentage on sale permission
- ErrorException: [E_WARNING] Undefined variable $providers in src/addons/XFA/RMMarketplace/Pub/Controller/Dashboard.php at line 392
- Бесплатные не отображаются в виде сетки, когда цена ресурса равна 0,00
- Фильтр на странице лицензии пользователя перенаправляет на индекс форума
- Фильтр бесплатных ресурсов не работает должным образом
- Невозможно добавить строку бесплатной доставки в физических ресурсах
- Исправлена некорректная ссылка на ваши покупки в поднавигации по ресурсам

### Модификации:

- Кнопка «Добавить лицензию» перемещена под вкладки панели инструментов
- Изменен макет отображения элемента сетки, чтобы приспособиться к отображению скидки
- Добавлена дата счета в списке счетов
- Некоторые вкладки панели инструментов переименованы
- Удалена вкладка «Главная панель» — Главная по умолчанию для «Статистика», «Продажи» или «Лицензии» в зависимости от разрешений
- Вкладки «Положения и условия» и «Выставление счетов» объединены во вкладку «Конфигурация»
- Возможность настроить количество дней, по истечении которых неоплаченные покупки автоматически удаляются (вместо фиксированного 1 дня)
- Изменены группы интерфейса разрешений

### Новые возможности:

- Возможность создания скидки
- Возможность вручную подтвердить неоплаченную покупку
- Возможность добавить лицензию со страницы ресурсов через меню ресурсов
- Предупреждающее сообщение в форме покупки, когда пользователь владеет лицензией с истекшим сроком действия, с вопросом, не хочет ли он ее продлить
- Возможность в цифровых продуктах запретить продление лицензии после истечения срока ее действия
- В список покупок добавлен фильтр периода времени
- Экспорт журнала продаж в .xlsx или .csv со страницы продаж на приборной панели
- Необязательная автоматическая блокировка пользовательских продаж через X дней после ежемесячного формирования счета-фактуры на процент от продажи, если он не оплачен (решение для платежного профиля xF)
- Возможность отключить/включить продажу ресурса
- Добавлены новые поддерживаемые платежные профили xF: Mollie, BTCPay
- Возможность на основе разрешения для продавца выбирать, какие средства связи использовать (электронная почта / разговор) при покупке / возврате
- Возможность, основанная на разрешениях, для продавца настраивать заголовок / сообщение, отправляемое при покупке / возврате, на вкладке конфигурации панели инструментов
- Новый фильтр статуса (неоплаченный, проверенный, возмещенный) на странице продаж в панели управления

## 5.0.4 от 15 января 2022

### Отладочный релиз

### Исправлены ошибки:

- ErrorException: Template error: [E_WARNING] Attempt to read property "group_id" on null src/addons/XFA/RMMarketplace/Listener.php:175

## 5.0.3 от 5 января 2022

### Отладочный релиз

### Исправлены ошибки

- ErrorException: Template error: [E_WARNING] Attempt to read property "xfa_rmmp_type" on null src/addons/XFA/RMMarketplace/XF/Entity/Thread.php:79
- ErrorException: Template error: [E_WARNING] Undefined variable $resource src/addons/XFA/RMMarketplace/XF/Entity/Thread.php:79
- Сумма доставки отображается в списке продаж, даже если она равна нулю
- Адрес пользователя требуется в платежном профиле PayPal для цифровых продуктов

## 5.0.2 от 30 декабря 2021

### Отладочный релиз

### Исправлены ошибки

- Неверное описание опций платежных провайдеров в admincp (данные зашифрованы)
- XF\Db\Exception: MySQL statement prepare error [1054]: Unknown column 'shipping' in 'field list' in src/XF/Db/AbstractStatement.php at line 228
- Для платежных профилей Paypal XF требуется только адрес, если продукт имеет физический тип

Платежный профиль Coinbase Commerce Integration теперь поддерживается после выпуска нашего основного дополнения 1.11.1.

## 5.0.1 от 1 декабря 2021

### Отладочный релиз

### Исправлены ошибки:

- ErrorException: Template error: [E_USER_WARNING] Cannot call method isForSaleInMarketplace on a non-object (NULL) src/XF/Template/Templater.php:1176
- Ввод дополнительных информационных данных, отображаемых для других типов продуктов, кроме физических

## 5.0.0 от 24 ноября 2021

### Основные изменения функций — поддержка платежных профилей xF

Эта новая версия представляет собой выпуск с основными изменениями функций, который содержит обширный набор улучшений и, в частности, реализацию нового режима оплаты на основе платежных профилей xF (настроенных либо администратором, либо пользователем).

Мы хотели бы поблагодарить @frybread за финансирование разработки этой новой функции.

Она была тщательно протестирована, но мы рекомендуем вам сначала протестировать эту новую версию в среде разработки, прежде чем запускать ее. И не забудьте сделать резервную копию ваших файлов и базы данных перед выполнением обновления.

Подробный журнал изменений представлен ниже.

### Исправлены ошибки:

- Изображение по умолчанию неправильно отображалось в режиме макета сетки, когда активирована опция дружественных URL-адресов
- Неправильная компоновка окна сетки, когда звезды не помещаются на одной строке

### Модификации:

- Поместите кнопки покупки и загрузки в группу, когда отображаются обе
- Разрешения разделены на две категории: стандартные разрешения / разрешения модератора.
- Переформулировка текста некоторых разрешений

### Новые возможности:

- Обновленная страница параметров с сортировкой вкладок
- Обновлена форма подтверждения покупки
- В админке изменены ссылки на продолжительность/рекомендацию покупок
- Цена добавлена рядом с продолжительностью на странице покупок в админке
- Возможность приобрести цифровой продукт для друга (на основе разрешения)
- Послебитовые индикаторы продавца/покупателя/действительных лицензий в ветках обсуждения ресурсов (на основе свойств стиля)
- Новые разрешения
  - Процент обхода разрешения на продажу
  - Максимальное количество товаров в продаже
- Настраиваемые автоматически отображаемые префиксы в списке ресурсов для идентификации цифровых продуктов/услуг/физических продуктов/физических продуктов, которых нет в наличии
- Кнопка предварительного просмотра счета на странице панели выставления счетов
- Новый режим обработки платежей на основе платежных профилей xF
  - Платежные профили, основанные на профилях администратора или настраиваемых пользователем интерфейсе
  - Поддерживаемые методы:
    - Настроенные внутренние методы: любые
    - Методы, настроенные для внешнего интерфейса: Paypal, Braintree, Stripe, 2checkout (свяжитесь с нами, чтобы добавить дополнительные способы оплаты)
  - Ежемесячная генерация счетов на оплату процентов от продаж пользователями на основе эффективных продаж
  - Электронная почта / оповещения, отправленные при создании счета / оплате / возврате
  - Конфигурация профилей оплаты на стороне пользователя с панели управления
  - Конфигурация платежных профилей на стороне пользователя, зашифрованная в базу данных
  - Страница ваших счетов на лицевой стороне
  - Страница со списком счетов на бэкенде
  - Отправить напоминание из списка счетов для неоплаченного счета
- Простое управление транспортными расходами
  - Ввод местоположения/стоимости при редактировании ресурса
  - Стоимость доставки автоматически добавляется к цене товара при покупке
